
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>1.6. Scipy : high-level scientific computing &#8212; Scipy lecture notes</title>
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="1.6.11.1. Maximum wind speed prediction at the Sprogø station" href="summary-exercises/stats-interpolate.html" />
    <link rel="prev" title="Text printing decorated" href="matplotlib/auto_examples/pretty_plots/plot_text_ext.html" />
   
    <link rel="stylesheet"
	  href="https://unpkg.com/purecss@1.0.0/build/base-min.css">

<script type="text/javascript">
$(function () {
    // Highlight the table of content as we scroll
    sections = {},
    i        = 0,
    url	 = document.URL.replace(/#.*$/, ""),
    current_section = 0;

    // Grab positions of our sections
    $('.headerlink').each(function(){
        sections[this.href.replace(url, '')] = $(this).offset().top - 50;
    });

    $(window).scroll(function(event) {
	var pos   = $(window).scrollTop();

	// Highlight the current section
	$('a.internal').parent().removeClass('active');
        for(i in sections){
            if(sections[i] > pos){
		break;
            };
	    if($('a.internal[href$="' + i + '"]').is(':visible')){
		current_section = i;
	    };
        }
	$('a.internal[href$="' + current_section + '"]').parent().addClass('active');
	$('a.internal[href$="' + current_section + '"]').parent().parent().parent().addClass('active');
	$('a.internal[href$="' + current_section + '"]').parent().parent().parent().parent().parent().addClass('active');
    });

});
</script>


  </head><body>
   <!-- Use the header to add javascript -->
    

    <script type="text/javascript">
    // Function to collapse the tip divs
    function collapse_tip_div(obj){
	// Update the representation on the tip div based on whether it
	// has the 'collapsed' css class or not: we only want to
	// collapse divs that are not already collapsed
	if($(obj).hasClass("collapsed")) {
	} else {
	    $(obj).find("p.summary").remove();
	    var content = $(obj).text();
	    var html = $(obj).html();

	    if(content.length > 40) {
		if ($.browser.msie) {
		    // We start at '3' to avoid 'tip', as IE
		    // does not count whitespace
		    var content = content.substr(3, 50);
		} else {
		    // We start at '5' to avoid 'tip '
		    var content = content.substr(5, 50);
		}
	    }
	    $(obj).html('<p class="summary"><img src="../_static/plus.png">' + content + '...</p>' + html);
	}
    }
    </script>

    <script type="text/javascript">
    $(function () {
	$(".tip")
	    .click(function(event){
		$(this).toggleClass("collapsed");
		// Change state of the global button
		$('div.related li.transparent').removeClass('transparent')
		$(this).find("p.summary").remove();
		if($(this).hasClass("collapsed")) {
		    var content = $(this).text();
		    var html = $(this).html();

		    if(content.length > 40) {
			if ($.browser.msie) {
			    // We start at '3' to avoid 'tip', as IE
			    // does not count whitespace
			    var content = content.substr(3, 50);
			} else {
			    // We start at '5' to avoid 'tip '
			    var content = content.substr(5, 50);
			}
		    }
		    $(this).html('<p class="summary"><img src="../_static/plus.png">' + content + '...</p>' + html);
		}
		if (event.target.tagName.toLowerCase() != "a") {
                   return true; //Makes links clickable
		}
	});
    });
    </script>


    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="summary-exercises/stats-interpolate.html" title="1.6.11.1. Maximum wind speed prediction at the Sprogø station"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="matplotlib/auto_examples/pretty_plots/plot_text_ext.html" title="Text printing decorated"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Scipy lecture notes</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">1. Getting started with Python for science</a> &#187;</li>
     
    <!-- Insert a menu in the navigation bar -->
    <li class="left">
	<!-- On click toggle the 'tip' on or off-->
	<a onclick="$('.tip').each(function (index, obj) {
			    collapse_tip_div(obj);
		    });
		    $('.tip').addClass('collapsed');
		    $('.left').addClass('transparent');">
	<img src="../_static/minus.png"
         alt="Collapse to compact view" style="padding: 1ex;"/>
	<span class="hiddenlink">Collapse document to compact view</span>
    </a></li>
    <li class="right edit_on_github"><a href="https://github.com/scipy-lectures/scipy-lecture-notes/edit/master/intro/scipy.rst">Edit
    <span class="tooltip">
	Improve this page:<br/>Edit it on Github.
    </span>
    </a>
    </li>

      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="scipy-high-level-scientific-computing">
<span id="scipy"></span><h1>1.6. Scipy : high-level scientific computing<a class="headerlink" href="#scipy-high-level-scientific-computing" title="Permalink to this headline">¶</a></h1>
<p><strong>Authors</strong>: <em>Gaël Varoquaux, Adrien Chauve, Andre Espaze, Emmanuelle Gouillart, Ralf Gommers</em></p>
<div class="topic">
<p class="topic-title">Scipy</p>
<p>The <a class="reference external" href="https://docs.scipy.org/doc/scipy/index.html#module-scipy" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy</span></code></a> package contains various toolboxes dedicated to common
issues in scientific computing. Its different submodules correspond
to different applications, such as interpolation, integration,
optimization, image processing, statistics, special functions, etc.</p>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/index.html#module-scipy" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy</span></code></a> can be compared to other standard scientific-computing
libraries, such as the GSL (GNU Scientific  Library for C and C++),
or Matlab’s toolboxes. <code class="docutils literal notranslate"><span class="pre">scipy</span></code> is the core package for scientific
routines in Python; it is meant to operate efficiently on <code class="docutils literal notranslate"><span class="pre">numpy</span></code>
arrays, so that numpy and scipy work hand in hand.</p>
<p class="last">Before implementing a routine, it is worth checking if the desired
data processing is not already implemented in Scipy. As
non-professional programmers, scientists often tend to <strong>re-invent the
wheel</strong>, which leads to buggy, non-optimal, difficult-to-share and
unmaintainable code. By contrast, <code class="docutils literal notranslate"><span class="pre">Scipy</span></code>’s routines are optimized
and tested, and should therefore be used when possible.</p>
</div>
<div class="contents local topic" id="chapters-contents">
<p class="topic-title">Chapters contents</p>
<ul class="simple">
<li><a class="reference internal" href="#file-input-output-scipy-io" id="id23">File input/output: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/io.html#module-scipy.io" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.io</span></code></a></a></li>
<li><a class="reference internal" href="#special-functions-scipy-special" id="id24">Special functions: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/special.html#module-scipy.special" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.special</span></code></a></a></li>
<li><a class="reference internal" href="#linear-algebra-operations-scipy-linalg" id="id25">Linear algebra operations: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/linalg.html#module-scipy.linalg" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.linalg</span></code></a></a></li>
<li><a class="reference internal" href="#interpolation-scipy-interpolate" id="id26">Interpolation: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/interpolate.html#module-scipy.interpolate" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.interpolate</span></code></a></a></li>
<li><a class="reference internal" href="#optimization-and-fit-scipy-optimize" id="id27">Optimization and fit: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/optimize.html#module-scipy.optimize" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.optimize</span></code></a></a></li>
<li><a class="reference internal" href="#statistics-and-random-numbers-scipy-stats" id="id28">Statistics and random numbers: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/stats.html#module-scipy.stats" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.stats</span></code></a></a></li>
<li><a class="reference internal" href="#numerical-integration-scipy-integrate" id="id29">Numerical integration: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/integrate.html#module-scipy.integrate" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.integrate</span></code></a></a></li>
<li><a class="reference internal" href="#fast-fourier-transforms-scipy-fftpack" id="id30">Fast Fourier transforms: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/fftpack.html#module-scipy.fftpack" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.fftpack</span></code></a></a></li>
<li><a class="reference internal" href="#signal-processing-scipy-signal" id="id31">Signal processing: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/signal.html#module-scipy.signal" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.signal</span></code></a></a></li>
<li><a class="reference internal" href="#image-manipulation-scipy-ndimage" id="id32">Image manipulation: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/ndimage.html#module-scipy.ndimage" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.ndimage</span></code></a></a></li>
<li><a class="reference internal" href="#summary-exercises-on-scientific-computing" id="id33">Summary exercises on scientific computing</a></li>
<li><a class="reference internal" href="#full-code-examples-for-the-scipy-chapter" id="id34">Full code examples for the scipy chapter</a></li>
</ul>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This tutorial is far from an introduction to numerical computing.
As enumerating the different submodules and functions in scipy would
be very boring, we concentrate instead on a few examples to give a
general idea of how to use <code class="docutils literal notranslate"><span class="pre">scipy</span></code> for scientific computing.</p>
</div>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/index.html#module-scipy" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy</span></code></a> is composed of task-specific sub-modules:</p>
<table border="1" class="docutils">
<colgroup>
<col width="39%" />
<col width="61%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/cluster.html#module-scipy.cluster" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.cluster</span></code></a></td>
<td>Vector quantization / Kmeans</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/constants.html#module-scipy.constants" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.constants</span></code></a></td>
<td>Physical and mathematical constants</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/fftpack.html#module-scipy.fftpack" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.fftpack</span></code></a></td>
<td>Fourier transform</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/integrate.html#module-scipy.integrate" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.integrate</span></code></a></td>
<td>Integration routines</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/interpolate.html#module-scipy.interpolate" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.interpolate</span></code></a></td>
<td>Interpolation</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/io.html#module-scipy.io" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.io</span></code></a></td>
<td>Data input and output</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/linalg.html#module-scipy.linalg" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.linalg</span></code></a></td>
<td>Linear algebra routines</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/ndimage.html#module-scipy.ndimage" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.ndimage</span></code></a></td>
<td>n-dimensional image package</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/odr.html#module-scipy.odr" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.odr</span></code></a></td>
<td>Orthogonal distance regression</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/optimize.html#module-scipy.optimize" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.optimize</span></code></a></td>
<td>Optimization</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/signal.html#module-scipy.signal" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.signal</span></code></a></td>
<td>Signal processing</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/sparse.html#module-scipy.sparse" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.sparse</span></code></a></td>
<td>Sparse matrices</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/spatial.html#module-scipy.spatial" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.spatial</span></code></a></td>
<td>Spatial data structures and algorithms</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/special.html#module-scipy.special" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.special</span></code></a></td>
<td>Any special mathematical functions</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/stats.html#module-scipy.stats" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.stats</span></code></a></td>
<td>Statistics</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>They all depend on <a class="reference external" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="(in NumPy v1.23)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">numpy</span></code></a>, but are mostly independent of each
other. The standard way of importing Numpy and these Scipy modules
is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>  <span class="c1"># same for other sub-modules</span>
<div class="newline"></div></pre></div>
</div>
<p class="last">The main <a class="reference external" href="https://docs.scipy.org/doc/scipy/index.html#module-scipy" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy</span></code></a> namespace mostly contains functions that are really
numpy functions (try <code class="docutils literal notranslate"><span class="pre">scipy.cos</span> <span class="pre">is</span> <span class="pre">np.cos</span></code>). Those are exposed for
historical reasons; there’s no reason to use <code class="docutils literal notranslate"><span class="pre">import</span>
<span class="pre">scipy</span></code> in your code.</p>
</div>
<div class="section" id="file-input-output-scipy-io">
<h2><a class="toc-backref" href="#id23">1.6.1. File input/output: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/io.html#module-scipy.io" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.io</span></code></a></a><a class="headerlink" href="#file-input-output-scipy-io" title="Permalink to this headline">¶</a></h2>
<p><strong>Matlab files</strong>: Loading and saving:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">io</span> <span class="k">as</span> <span class="n">spio</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">spio</span><span class="o">.</span><span class="n">savemat</span><span class="p">(</span><span class="s1">&#39;file.mat&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="n">a</span><span class="p">})</span> <span class="c1"># savemat expects a dictionary</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">spio</span><span class="o">.</span><span class="n">loadmat</span><span class="p">(</span><span class="s1">&#39;file.mat&#39;</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span>
<div class="newline"></div><span class="go">array([[1.,  1.,  1.],</span>
<div class="newline"></div><span class="go">       [1.,  1.,  1.],</span>
<div class="newline"></div><span class="go">       [1.,  1.,  1.]])</span>
<div class="newline"></div></pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p><strong>Python / Matlab mismatches</strong>, <em>eg</em> matlab does not represent 1D arrays</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<div class="newline"></div><span class="go">array([1.,  1.,  1.])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">spio</span><span class="o">.</span><span class="n">savemat</span><span class="p">(</span><span class="s1">&#39;file.mat&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="n">a</span><span class="p">})</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">spio</span><span class="o">.</span><span class="n">loadmat</span><span class="p">(</span><span class="s1">&#39;file.mat&#39;</span><span class="p">)[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span>
<div class="newline"></div><span class="go">array([[1.,  1.,  1.]])</span>
<div class="newline"></div></pre></div>
</div>
<p class="last">Notice the difference?</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Image files</strong>: Reading images:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">imageio</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">imageio</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;fname.png&#39;</span><span class="p">)</span>    
<div class="newline"></div><span class="go">Array(...)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Matplotlib also has a similar function</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;fname.png&#39;</span><span class="p">)</span>    
<div class="newline"></div><span class="go">array(...)</span>
<div class="newline"></div></pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li>Load text files: <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.loadtxt.html#numpy.loadtxt" title="(in NumPy v1.23)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.loadtxt()</span></code></a>/<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.savetxt.html#numpy.savetxt" title="(in NumPy v1.23)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.savetxt()</span></code></a></li>
<li>Clever loading of text/csv files:
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.genfromtxt.html#numpy.genfromtxt" title="(in NumPy v1.23)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.genfromtxt()</span></code></a>/<code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.recfromcsv()</span></code></li>
<li>Fast and efficient, but numpy-specific, binary format:
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.save.html#numpy.save" title="(in NumPy v1.23)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.save()</span></code></a>/<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.load.html#numpy.load" title="(in NumPy v1.23)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.load()</span></code></a></li>
<li>More advanced input/output of images in scikit-image: <a class="reference external" href="https://scikit-image.org/docs/stable/api/skimage.io.html#module-skimage.io" title="(in skimage v0.19.2)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">skimage.io</span></code></a></li>
</ul>
</div>
</div>
<div class="section" id="special-functions-scipy-special">
<h2><a class="toc-backref" href="#id24">1.6.2. Special functions: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/special.html#module-scipy.special" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.special</span></code></a></a><a class="headerlink" href="#special-functions-scipy-special" title="Permalink to this headline">¶</a></h2>
<p>Special functions are transcendental functions. The docstring of the
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/special.html#module-scipy.special" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.special</span></code></a> module is well-written, so we won’t list all
functions here. Frequently used ones are:</p>
<blockquote>
<div><ul class="simple">
<li>Bessel function, such as <code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.special.jn()</span></code> (nth integer order Bessel
function)</li>
<li>Elliptic function (<code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.special.ellipj()</span></code> for the Jacobian elliptic
function, …)</li>
<li>Gamma function: <code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.special.gamma()</span></code>, also note
<code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.special.gammaln()</span></code> which
will give the log of Gamma to a higher numerical precision.</li>
<li>Erf, the area under a Gaussian curve: <code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.special.erf()</span></code></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="linear-algebra-operations-scipy-linalg">
<span id="scipy-linalg"></span><h2><a class="toc-backref" href="#id25">1.6.3. Linear algebra operations: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/linalg.html#module-scipy.linalg" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.linalg</span></code></a></a><a class="headerlink" href="#linear-algebra-operations-scipy-linalg" title="Permalink to this headline">¶</a></h2>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">The <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/linalg.html#module-scipy.linalg" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.linalg</span></code></a> module provides standard linear algebra
operations, relying on an underlying efficient implementation (BLAS,
LAPACK).</p>
</div>
<ul>
<li><p class="first">The <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.det.html#scipy.linalg.det" title="(in SciPy v1.9.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.linalg.det()</span></code></a> function computes the determinant of a
square matrix:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">linalg</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<div class="newline"></div><span class="gp">... </span>                <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<div class="newline"></div><span class="go">-2.0</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<div class="newline"></div><span class="gp">... </span>                <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span> 
<div class="newline"></div><span class="go">0.0</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)))</span>
<div class="newline"></div><span class="gt">Traceback (most recent call last):</span>
<div class="newline"></div><span class="c">...</span>
<div class="newline"></div><span class="gr">ValueError</span>: <span class="n">expected square matrix</span>
<div class="newline"></div></pre></div>
</div>
</li>
<li><p class="first">The <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.inv.html#scipy.linalg.inv" title="(in SciPy v1.9.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.linalg.inv()</span></code></a> function computes the inverse of a square
matrix:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<div class="newline"></div><span class="gp">... </span>                <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">iarr</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">iarr</span>
<div class="newline"></div><span class="go">array([[-2. ,  1. ],</span>
<div class="newline"></div><span class="go">       [ 1.5, -0.5]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">iarr</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<div class="newline"></div><span class="go">True</span>
<div class="newline"></div></pre></div>
</div>
<p>Finally computing the inverse of a singular matrix (its determinant is zero)
will raise <code class="docutils literal notranslate"><span class="pre">LinAlgError</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<div class="newline"></div><span class="gp">... </span>                <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>  
<div class="newline"></div><span class="gt">Traceback (most recent call last):</span>
<div class="newline"></div><span class="c">...</span>
<div class="newline"></div><span class="gr">...LinAlgError</span>: <span class="n">singular matrix</span>
<div class="newline"></div></pre></div>
</div>
</li>
<li><p class="first">More advanced operations are available, for example singular-value
decomposition (SVD):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">uarr</span><span class="p">,</span> <span class="n">spec</span><span class="p">,</span> <span class="n">vharr</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>The resulting array spectrum is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">spec</span>    
<div class="newline"></div><span class="go">array([14.88982544,   0.45294236,   0.29654967])</span>
<div class="newline"></div></pre></div>
</div>
<p>The original matrix can be re-composed by matrix multiplication of the outputs of
<code class="docutils literal notranslate"><span class="pre">svd</span></code> with <code class="docutils literal notranslate"><span class="pre">np.dot</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sarr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">svd_mat</span> <span class="o">=</span> <span class="n">uarr</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">sarr</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">vharr</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">svd_mat</span><span class="p">,</span> <span class="n">arr</span><span class="p">)</span>
<div class="newline"></div><span class="go">True</span>
<div class="newline"></div></pre></div>
</div>
<p>SVD is commonly used in statistics and signal processing.  Many other
standard decompositions (QR, LU, Cholesky, Schur), as well as solvers
for linear systems, are available in <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/linalg.html#module-scipy.linalg" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.linalg</span></code></a>.</p>
</li>
</ul>
</div>
<div class="section" id="interpolation-scipy-interpolate">
<span id="intro-scipy-interpolate"></span><h2><a class="toc-backref" href="#id26">1.6.4. Interpolation: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/interpolate.html#module-scipy.interpolate" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.interpolate</span></code></a></a><a class="headerlink" href="#interpolation-scipy-interpolate" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/interpolate.html#module-scipy.interpolate" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.interpolate</span></code></a> is useful for fitting a function from experimental
data and thus evaluating points where no measure exists. The module is based
on the <a class="reference external" href="http://www.netlib.org/dierckx/index.html">FITPACK Fortran subroutines</a>.</p>
<p>By imagining experimental data close to a sine function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">measured_time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">noise</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e-1</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">measures</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">measured_time</span><span class="p">)</span> <span class="o">+</span> <span class="n">noise</span>
<div class="newline"></div></pre></div>
</div>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.interp1d.html#scipy.interpolate.interp1d" title="(in SciPy v1.9.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.interpolate.interp1d</span></code></a> can build a linear interpolation
function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">interp1d</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">linear_interp</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">measured_time</span><span class="p">,</span> <span class="n">measures</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<a class="reference external image-reference" href="scipy/auto_examples/plot_interpolation.html"><img alt="../_images/sphx_glr_plot_interpolation_001.png" class="align-right" src="../_images/sphx_glr_plot_interpolation_001.png" style="width: 360.0px; height: 240.0px;" /></a>
<p>Then the result can be evaluated at the time of interest:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">interpolation_time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">linear_results</span> <span class="o">=</span> <span class="n">linear_interp</span><span class="p">(</span><span class="n">interpolation_time</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>A cubic interpolation can also be selected by providing the <code class="docutils literal notranslate"><span class="pre">kind</span></code> optional
keyword argument:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cubic_interp</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">measured_time</span><span class="p">,</span> <span class="n">measures</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">cubic_results</span> <span class="o">=</span> <span class="n">cubic_interp</span><span class="p">(</span><span class="n">interpolation_time</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.interp2d.html#scipy.interpolate.interp2d" title="(in SciPy v1.9.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.interpolate.interp2d</span></code></a> is similar to
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.interp1d.html#scipy.interpolate.interp1d" title="(in SciPy v1.9.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.interpolate.interp1d</span></code></a>, but for 2-D arrays. Note that for
the <cite>interp</cite> family, the interpolation points must stay within the range
of given data points. See the summary exercise on
<a class="reference internal" href="summary-exercises/stats-interpolate.html#summary-exercise-stat-interp"><span class="std std-ref">Maximum wind speed prediction at the Sprogø station</span></a> for a more advanced spline
interpolation example.</p>
</div>
<div class="section" id="optimization-and-fit-scipy-optimize">
<h2><a class="toc-backref" href="#id27">1.6.5. Optimization and fit: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/optimize.html#module-scipy.optimize" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.optimize</span></code></a></a><a class="headerlink" href="#optimization-and-fit-scipy-optimize" title="Permalink to this headline">¶</a></h2>
<p>Optimization is the problem of finding a numerical solution to a
minimization or equality.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>The <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/optimize.html#module-scipy.optimize" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.optimize</span></code></a> module provides algorithms for function
minimization (scalar or multi-dimensional), curve fitting and root
finding.</p>
<div class="last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
<div class="newline"></div></pre></div>
</div>
</div>
<div class="section" id="curve-fitting">
<h3>1.6.5.1. Curve fitting<a class="headerlink" href="#curve-fitting" title="Permalink to this headline">¶</a></h3>
<a class="reference external image-reference" href="scipy/auto_examples/plot_curve_fit.html"><img alt="../_images/sphx_glr_plot_curve_fit_001.png" class="align-right" src="../_images/sphx_glr_plot_curve_fit_001.png" style="width: 300.0px; height: 200.0px;" /></a>
<p>Suppose we have data on a sine wave, with some noise:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">y_data</span> <span class="o">=</span> <span class="mf">2.9</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">1.5</span> <span class="o">*</span> <span class="n">x_data</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>If we know that the data lies on a sine wave, but not the amplitudes
or the period, we can find those by least squares curve fitting. First we
have to define the test function to fit, here a sine with unknown
amplitude and period:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">test_func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<div class="newline"></div><span class="gp">... </span>    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">b</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<a class="reference external image-reference" href="scipy/auto_examples/plot_curve_fit.html"><img alt="../_images/sphx_glr_plot_curve_fit_002.png" class="align-right" src="../_images/sphx_glr_plot_curve_fit_002.png" style="width: 300.0px; height: 200.0px;" /></a>
<p>We then use <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html#scipy.optimize.curve_fit" title="(in SciPy v1.9.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.curve_fit()</span></code></a> to find <img class="math" src="../_images/math/bd9d9c7512c898e0a254a0882184197bc1bd9c9f.png" alt="a"/> and <img class="math" src="../_images/math/57c9d14bb082716df9000146882ce365335d08f1.png" alt="b"/>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">params</span><span class="p">,</span> <span class="n">params_covariance</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">curve_fit</span><span class="p">(</span><span class="n">test_func</span><span class="p">,</span> <span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<div class="newline"></div><span class="go">[3.05931973  1.45754553]</span>
<div class="newline"></div></pre></div>
</div>
<div style="clear: both"></div><div class="green topic">
<p class="topic-title">Exercise: Curve fitting of temperature data</p>
<blockquote>
<div><p>The temperature extremes in Alaska for each month, starting in January, are
given by (in degrees Celcius):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">max</span><span class="p">:</span>  <span class="mi">17</span><span class="p">,</span>  <span class="mi">19</span><span class="p">,</span>  <span class="mi">21</span><span class="p">,</span>  <span class="mi">28</span><span class="p">,</span>  <span class="mi">33</span><span class="p">,</span>  <span class="mi">38</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span>  <span class="mi">37</span><span class="p">,</span>  <span class="mi">31</span><span class="p">,</span>  <span class="mi">23</span><span class="p">,</span>  <span class="mi">19</span><span class="p">,</span>  <span class="mi">18</span>
<div class="newline"></div><span class="nb">min</span><span class="p">:</span> <span class="o">-</span><span class="mi">62</span><span class="p">,</span> <span class="o">-</span><span class="mi">59</span><span class="p">,</span> <span class="o">-</span><span class="mi">56</span><span class="p">,</span> <span class="o">-</span><span class="mi">46</span><span class="p">,</span> <span class="o">-</span><span class="mi">32</span><span class="p">,</span> <span class="o">-</span><span class="mi">18</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">13</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mi">46</span><span class="p">,</span> <span class="o">-</span><span class="mi">52</span><span class="p">,</span> <span class="o">-</span><span class="mi">58</span>
<div class="newline"></div></pre></div>
</div>
<ol class="arabic simple">
<li>Plot these temperature extremes.</li>
<li>Define a function that can describe min and max temperatures.
Hint: this function has to have a period of 1 year.
Hint: include a time offset.</li>
<li>Fit this function to the data with <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html#scipy.optimize.curve_fit" title="(in SciPy v1.9.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.curve_fit()</span></code></a>.</li>
<li>Plot the result.  Is the fit reasonable?  If not, why?</li>
<li>Is the time offset for min and max temperatures the same within the fit
accuracy?</li>
</ol>
<p><a class="reference internal" href="scipy/auto_examples/solutions/plot_curvefit_temperature_data.html#sphx-glr-intro-scipy-auto-examples-solutions-plot-curvefit-temperature-data-py"><span class="std std-ref">solution</span></a></p>
</div></blockquote>
</div>
</div>
<div class="section" id="finding-the-minimum-of-a-scalar-function">
<h3>1.6.5.2. Finding the minimum of a scalar function<a class="headerlink" href="#finding-the-minimum-of-a-scalar-function" title="Permalink to this headline">¶</a></h3>
<a class="reference external image-reference" href="scipy/auto_examples/plot_optimize_example1.html"><img alt="../_images/sphx_glr_plot_optimize_example1_001.png" class="align-right" src="../_images/sphx_glr_plot_optimize_example1_001.png" style="width: 320.0px; height: 240.0px;" /></a>
<p>Let’s define the following function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<div class="newline"></div><span class="gp">... </span>    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>and plot it:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> 
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
<div class="newline"></div></pre></div>
</div>
<p>This function has a global minimum around -1.3 and a local minimum around
3.8.</p>
<p>Searching for minimum can be done with
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html#scipy.optimize.minimize" title="(in SciPy v1.9.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.minimize()</span></code></a>, given a starting point x0, it returns
the location of the minimum that it has found:</p>
<div class="sidebar">
<p class="first sidebar-title">result type</p>
<p class="last">The result of <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html#scipy.optimize.minimize" title="(in SciPy v1.9.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.minimize()</span></code></a> is a compound object
comprising all information on the convergence</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> 
<div class="newline"></div><span class="go">      fun: -7.9458233756...</span>
<div class="newline"></div><span class="go"> hess_inv: array([[0.0858...]])</span>
<div class="newline"></div><span class="go">      jac: array([-1.19209...e-06])</span>
<div class="newline"></div><span class="go">  message: &#39;Optimization terminated successfully.&#39;</span>
<div class="newline"></div><span class="go">     nfev: 18</span>
<div class="newline"></div><span class="go">      nit: 5</span>
<div class="newline"></div><span class="go">     njev: 6</span>
<div class="newline"></div><span class="go">   status: 0</span>
<div class="newline"></div><span class="go">  success: True</span>
<div class="newline"></div><span class="go">        x: array([-1.30644...])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">.</span><span class="n">x</span> <span class="c1"># The coordinate of the minimum  </span>
<div class="newline"></div><span class="go">array([-1.30644...])</span>
<div class="newline"></div></pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Methods</strong>:
As the function is a smooth function, gradient-descent based methods are
good options. The <a class="reference external" href="https://en.wikipedia.org/wiki/Limited-memory_BFGS">lBFGS algorithm</a> is a good choice
in general:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">optimize</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;L-BFGS-B&quot;</span><span class="p">)</span>  
<div class="newline"></div><span class="go">      fun: array([-7.94582338])</span>
<div class="newline"></div><span class="go"> hess_inv: &lt;1x1 LbfgsInvHessProduct with dtype=float64&gt;</span>
<div class="newline"></div><span class="go">      jac: array([-1.42108547e-06])</span>
<div class="newline"></div><span class="go">  message: ...&#39;CONVERGENCE: NORM_OF_PROJECTED_GRADIENT_&lt;=_PGTOL&#39;</span>
<div class="newline"></div><span class="go">     nfev: 12</span>
<div class="newline"></div><span class="go">      nit: 5</span>
<div class="newline"></div><span class="go">   status: 0</span>
<div class="newline"></div><span class="go">  success: True</span>
<div class="newline"></div><span class="go">        x: array([-1.30644013])</span>
<div class="newline"></div></pre></div>
</div>
<p>Note how it cost only 12 functions evaluation above to find a good value
for the minimum.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Global minimum</strong>:
A possible issue with this approach is that, if the function has local minima,
the algorithm may find these local minima instead of the
global minimum depending on the initial point x0:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;L-BFGS-B&quot;</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">x</span>
<div class="newline"></div><span class="go">array([3.83746709])</span>
<div class="newline"></div></pre></div>
</div>
<p>If we don’t know the neighborhood of the global minimum to choose the
initial point, we need to resort to costlier global optimization.  To
find the global minimum, we use <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.basinhopping.html#scipy.optimize.basinhopping" title="(in SciPy v1.9.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.basinhopping()</span></code></a>
(added in version 0.12.0 of Scipy). It combines a local optimizer with
sampling of starting points:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">optimize</span><span class="o">.</span><span class="n">basinhopping</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  
<div class="newline"></div><span class="go">                  nfev: 1725</span>
<div class="newline"></div><span class="go"> minimization_failures: 0</span>
<div class="newline"></div><span class="go">                   fun: -7.9458233756152845</span>
<div class="newline"></div><span class="go">                     x: array([-1.30644001])</span>
<div class="newline"></div><span class="go">               message: [&#39;requested number of basinhopping iterations completed successfully&#39;]</span>
<div class="newline"></div><span class="go">                  njev: 575</span>
<div class="newline"></div><span class="go">                   nit: 100</span>
<div class="newline"></div></pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><a class="reference external" href="https://docs.scipy.org/doc/scipy/index.html#module-scipy" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy</span></code></a> used to contain the routine <cite>anneal</cite>, it has been removed in
SciPy 0.16.0.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Constraints</strong>:
We can constrain the variable to the interval
<code class="docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">10)</span></code> using the “bounds” argument:</p>
<div class="sidebar">
<p class="first sidebar-title">A list of bounds</p>
<p class="last">As <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html#scipy.optimize.minimize" title="(in SciPy v1.9.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">minimize()</span></code></a> works in general with x
multidimensionsal, the “bounds” argument is a list of bound on each
dimension.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<div class="newline"></div><span class="gp">... </span>                        <span class="n">bounds</span><span class="o">=</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">x</span>    
<div class="newline"></div><span class="go">array([0.])</span>
<div class="newline"></div></pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">What has happened? Why are we finding 0, which is not a mimimum of our
function.</p>
</div>
<div class="topic">
<p class="topic-title"><strong>Minimizing functions of several variables</strong></p>
<p>To minimize over several variables, the trick is to turn them into a
function of a multi-dimensional variable (a vector). See for instance
the exercise on 2D minimization below.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize_scalar.html#scipy.optimize.minimize_scalar" title="(in SciPy v1.9.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.minimize_scalar()</span></code></a> is a function with dedicated
methods to minimize functions of only one variable.</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">Finding minima of function is discussed in more details in the
advanced chapter: <a class="reference internal" href="../advanced/mathematical_optimization/index.html#mathematical-optimization"><span class="std std-ref">Mathematical optimization: finding minima of functions</span></a>.</p>
</div>
<div class="green topic">
<p class="topic-title">Exercise: 2-D minimization</p>
<blockquote>
<div><a class="reference external image-reference" href="scipy/auto_examples/plot_2d_minimization.html"><img alt="../_images/sphx_glr_plot_2d_minimization_002.png" class="align-right" src="../_images/sphx_glr_plot_2d_minimization_002.png" style="width: 320.0px; height: 240.0px;" /></a>
<p>The six-hump camelback function</p>
<div class="math">
<p><img src="../_images/math/212c854460799911461c3821bcee844578117633.png" alt="f(x, y) = (4 - 2.1x^2 + \frac{x^4}{3})x^2 + xy + (4y^2 - 4)y^2"/></p>
</div><p>has multiple global and local minima. Find the global minima of this
function.</p>
<p>Hints:</p>
<blockquote>
<div><ul class="simple">
<li>Variables can be restricted to <img class="math" src="../_images/math/5aab515be480b6f12bc5f722a5775b3f4682692d.png" alt="-2 &lt; x &lt; 2"/> and <img class="math" src="../_images/math/cac27573c047f6c2a52e9e369e546068f1cfcec3.png" alt="-1 &lt; y &lt; 1"/>.</li>
<li>Use <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.meshgrid.html#numpy.meshgrid" title="(in NumPy v1.23)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.meshgrid()</span></code></a> and <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="(in Matplotlib v3.5.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">matplotlib.pyplot.imshow()</span></code></a> to
find visually the regions.</li>
<li>Use <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html#scipy.optimize.minimize" title="(in SciPy v1.9.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.minimize()</span></code></a>, optionally trying out
several of its methods.</li>
</ul>
</div></blockquote>
<p>How many global minima are there, and what is the function value at those
points?  What happens for an initial guess of <img class="math" src="../_images/math/e6115b7a802065cf81abe1b976700e5c5699b0fd.png" alt="(x, y) = (0, 0)"/> ?</p>
<p><a class="reference internal" href="scipy/auto_examples/plot_2d_minimization.html#sphx-glr-intro-scipy-auto-examples-plot-2d-minimization-py"><span class="std std-ref">solution</span></a></p>
</div></blockquote>
</div>
</div>
<div class="section" id="finding-the-roots-of-a-scalar-function">
<h3>1.6.5.3. Finding the roots of a scalar function<a class="headerlink" href="#finding-the-roots-of-a-scalar-function" title="Permalink to this headline">¶</a></h3>
<p>To find a root, i.e. a point where <img class="math" src="../_images/math/6504e3f0bdd624bb75e2c6f760ac542612e8e8fa.png" alt="f(x) = 0"/>, of the function <img class="math" src="../_images/math/875eb40014526135383caa89fd500ae40a835f56.png" alt="f"/> above
we can use <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.root.html#scipy.optimize.root" title="(in SciPy v1.9.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.root()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">root</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">root</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># our initial guess is 1</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">root</span>    <span class="c1"># The full result</span>
<div class="newline"></div><span class="go">    fjac: array([[-1.]])</span>
<div class="newline"></div><span class="go">     fun: array([0.])</span>
<div class="newline"></div><span class="go"> message: &#39;The solution converged.&#39;</span>
<div class="newline"></div><span class="go">    nfev: 10</span>
<div class="newline"></div><span class="go">     qtf: array([1.33310463e-32])</span>
<div class="newline"></div><span class="go">       r: array([-10.])</span>
<div class="newline"></div><span class="go">  status: 1</span>
<div class="newline"></div><span class="go"> success: True</span>
<div class="newline"></div><span class="go">       x: array([0.])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">root</span><span class="o">.</span><span class="n">x</span>  <span class="c1"># Only the root found</span>
<div class="newline"></div><span class="go">array([0.])</span>
<div class="newline"></div></pre></div>
</div>
<p>Note that only one root is found.  Inspecting the plot of <img class="math" src="../_images/math/875eb40014526135383caa89fd500ae40a835f56.png" alt="f"/> reveals that
there is a second root around -2.5. We find the exact value of it by adjusting
our initial guess:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">root2</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">root</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="o">=-</span><span class="mf">2.5</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">root2</span><span class="o">.</span><span class="n">x</span>
<div class="newline"></div><span class="go">array([-2.47948183])</span>
<div class="newline"></div></pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.root.html#scipy.optimize.root" title="(in SciPy v1.9.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.root()</span></code></a> also comes with a variety of algorithms,
set via the “method” argument.</p>
</div>
<a class="reference external image-reference" href="scipy/auto_examples/plot_optimize_example2.html"><img alt="../_images/sphx_glr_plot_optimize_example2_001.png" class="align-right" src="../_images/sphx_glr_plot_optimize_example2_001.png" style="width: 420.0px; height: 280.0px;" /></a>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Now that we have found the minima and roots of <code class="docutils literal notranslate"><span class="pre">f</span></code> and used curve fitting on it,
we put all those results together in a single plot:</p>
<div style="clear: both"></div><div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">You can find all algorithms and functions with similar functionalities
in the documentation of <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/optimize.html#module-scipy.optimize" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.optimize</span></code></a>.</p>
</div>
<p>See the summary exercise on <a class="reference internal" href="summary-exercises/optimize-fit.html#summary-exercise-optimize"><span class="std std-ref">Non linear least squares curve fitting: application to point extraction in topographical lidar data</span></a> for another, more
advanced example.</p>
</div>
</div>
<div class="section" id="statistics-and-random-numbers-scipy-stats">
<h2><a class="toc-backref" href="#id28">1.6.6. Statistics and random numbers: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/stats.html#module-scipy.stats" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.stats</span></code></a></a><a class="headerlink" href="#statistics-and-random-numbers-scipy-stats" title="Permalink to this headline">¶</a></h2>
<p>The module <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/stats.html#module-scipy.stats" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.stats</span></code></a> contains statistical tools and probabilistic
descriptions of random processes. Random number generators for various
random process can be found in <a class="reference external" href="https://numpy.org/doc/stable/reference/random/index.html#module-numpy.random" title="(in NumPy v1.23)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">numpy.random</span></code></a>.</p>
<div class="section" id="distributions-histogram-and-probability-density-function">
<h3>1.6.6.1. Distributions: histogram and probability density function<a class="headerlink" href="#distributions-histogram-and-probability-density-function" title="Permalink to this headline">¶</a></h3>
<p>Given observations of a random process, their histogram is an estimator of
the random process’s PDF (probability density function):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span>
<div class="newline"></div><span class="go">array([-4, -3, -2, -1,  0,  1,  2,  3,  4])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">histogram</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">bins</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span>
<div class="newline"></div><span class="go">array([-3.5, -2.5, -1.5, -0.5,  0.5,  1.5,  2.5,  3.5])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">pdf</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">bins</span><span class="p">)</span>  <span class="c1"># norm is a distribution object</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="n">histogram</span><span class="p">)</span> 
<div class="newline"></div><span class="go">[&lt;matplotlib.lines.Line2D object at ...&gt;]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="n">pdf</span><span class="p">)</span> 
<div class="newline"></div><span class="go">[&lt;matplotlib.lines.Line2D object at ...&gt;]</span>
<div class="newline"></div></pre></div>
</div>
<a class="reference external image-reference" href="scipy/auto_examples/plot_normal_distribution.html"><img alt="../_images/sphx_glr_plot_normal_distribution_001.png" src="../_images/sphx_glr_plot_normal_distribution_001.png" style="width: 420.0px; height: 280.0px;" /></a>
<div class="sidebar">
<p class="first sidebar-title"><strong>The distribution objects</strong></p>
<p class="last"><code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.stats.norm</span></code> is a distribution object: each distribution
in <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/stats.html#module-scipy.stats" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.stats</span></code></a> is represented as an object. Here it’s the
normal distribution, and it comes with a PDF, a CDF, and much more.</p>
</div>
<p>If we know that the random process belongs to a given family of random
processes, such as normal processes, we can do a maximum-likelihood fit
of the observations to estimate the parameters of the underlying
distribution. Here we fit a normal process to the observed data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">loc</span><span class="p">,</span> <span class="n">std</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">loc</span>     
<div class="newline"></div><span class="go">-0.045256707...</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">std</span>     
<div class="newline"></div><span class="go">0.9870331586...</span>
<div class="newline"></div></pre></div>
</div>
<div class="green topic">
<p class="topic-title">Exercise: Probability distributions</p>
<p>Generate 1000 random variates from a gamma distribution with a shape
parameter of 1, then plot a histogram from those samples.  Can you plot the
pdf on top (it should match)?</p>
<p>Extra: the distributions have many useful methods. Explore them by
reading the docstring or by using tab completion.  Can you recover
the shape parameter 1 by using the <code class="docutils literal notranslate"><span class="pre">fit</span></code> method on your random
variates?</p>
</div>
</div>
<div class="section" id="mean-median-and-percentiles">
<h3>1.6.6.2. Mean, median and percentiles<a class="headerlink" href="#mean-median-and-percentiles" title="Permalink to this headline">¶</a></h3>
<p>The mean is an estimator of the center of the distribution:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>     
<div class="newline"></div><span class="go">-0.0452567074...</span>
<div class="newline"></div></pre></div>
</div>
<p>The median another estimator of the center. It is the value with half of
the observations below, and half above:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>     
<div class="newline"></div><span class="go">-0.0580280347...</span>
<div class="newline"></div></pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">Unlike the mean, the median is not sensitive to the tails of the
distribution. It is <a class="reference external" href="https://en.wikipedia.org/wiki/Robust_statistics">“robust”</a>.</p>
</div>
<div class="green topic">
<p class="topic-title">Exercise: Compare mean and median on samples of a Gamma distribution</p>
<blockquote>
<div>Which one seems to be the best estimator of the center for the Gamma
distribution?</div></blockquote>
</div>
<p>The median is also the percentile 50, because 50% of the observation are
below it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span><span class="o">.</span><span class="n">scoreatpercentile</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>     
<div class="newline"></div><span class="go">-0.0580280347...</span>
<div class="newline"></div></pre></div>
</div>
<p>Similarly, we can calculate the percentile 90:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span><span class="o">.</span><span class="n">scoreatpercentile</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>     
<div class="newline"></div><span class="go">1.2315935511...</span>
<div class="newline"></div></pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">The percentile is an estimator of the CDF: cumulative distribution
function.</p>
</div>
</div>
<div class="section" id="statistical-tests">
<h3>1.6.6.3. Statistical tests<a class="headerlink" href="#statistical-tests" title="Permalink to this headline">¶</a></h3>
<a class="reference external image-reference" href="scipy/auto_examples/plot_t_test.html"><img alt="../_images/sphx_glr_plot_t_test_001.png" class="align-right" src="../_images/sphx_glr_plot_t_test_001.png" style="width: 360.0px; height: 240.0px;" /></a>
<p>A statistical test is a decision indicator. For instance, if we have two
sets of observations, that we assume are generated from Gaussian
processes, we can use a
<a class="reference external" href="https://en.wikipedia.org/wiki/Student%27s_t-test">T-test</a> to decide
whether the means of two sets of observations are significantly different:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>   
<div class="newline"></div><span class="go">(array(-3.177574054...), 0.0019370639...)</span>
<div class="newline"></div></pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>The resulting output is composed of:</p>
<ul class="last simple">
<li>The T statistic value: it is a number the sign of which is
proportional to the difference between the two random processes and
the magnitude is related to the significance of this difference.</li>
<li>the <em>p value</em>: the probability of both processes being identical. If it
is close to 1, the two process are almost certainly identical.
The closer it is to zero, the more likely it is that the processes
have different means.</li>
</ul>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">The chapter on <a class="reference internal" href="../packages/statistics/index.html#statistics"><span class="std std-ref">statistics</span></a> introduces much more
elaborate tools for statistical testing and statistical data
loading and visualization outside of scipy.</p>
</div>
</div>
</div>
<div class="section" id="numerical-integration-scipy-integrate">
<h2><a class="toc-backref" href="#id29">1.6.7. Numerical integration: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/integrate.html#module-scipy.integrate" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.integrate</span></code></a></a><a class="headerlink" href="#numerical-integration-scipy-integrate" title="Permalink to this headline">¶</a></h2>
<div class="section" id="function-integrals">
<h3>1.6.7.1. Function integrals<a class="headerlink" href="#function-integrals" title="Permalink to this headline">¶</a></h3>
<p>The most generic integration routine is <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html#scipy.integrate.quad" title="(in SciPy v1.9.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.integrate.quad()</span></code></a>. To
compute <img class="math" src="../_images/math/08c5a6cfb790304868ea9c2f58d7b6e3b5ea07fe.png" alt="\int_0^{\pi / 2} sin(t) dt"/>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>   <span class="c1"># res is the result, is should be close to 1</span>
<div class="newline"></div><span class="go">True</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">res</span><span class="p">)</span>  <span class="c1"># err is an estimate of the err</span>
<div class="newline"></div><span class="go">True</span>
<div class="newline"></div></pre></div>
</div>
<p>Other integration schemes are available:
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.fixed_quad.html#scipy.integrate.fixed_quad" title="(in SciPy v1.9.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.integrate.fixed_quad()</span></code></a>, <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quadrature.html#scipy.integrate.quadrature" title="(in SciPy v1.9.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.integrate.quadrature()</span></code></a>,
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.romberg.html#scipy.integrate.romberg" title="(in SciPy v1.9.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.integrate.romberg()</span></code></a>…</p>
</div>
<div class="section" id="integrating-differential-equations">
<h3>1.6.7.2. Integrating differential equations<a class="headerlink" href="#integrating-differential-equations" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/integrate.html#module-scipy.integrate" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.integrate</span></code></a> also features routines for integrating <a class="reference external" href="https://en.wikipedia.org/wiki/Ordinary_differential_equation">Ordinary
Differential Equations (ODE)</a>. In
particular, <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.odeint.html#scipy.integrate.odeint" title="(in SciPy v1.9.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.integrate.odeint()</span></code></a> solves ODE of the form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dy</span><span class="o">/</span><span class="n">dt</span> <span class="o">=</span> <span class="n">rhs</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="o">..</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span><span class="o">...</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>As an introduction, let us solve the ODE <img class="math" src="../_images/math/301861953f7cabbfeae2708e4c5b01851cbef8ec.png" alt="\frac{dy}{dt} = -2 y"/> between
<img class="math" src="../_images/math/e5b174354c162b0ceffce059f27209982d90eb10.png" alt="t = 0 \dots 4"/>, with the  initial condition <img class="math" src="../_images/math/144939cf068a446c48642acd9e895f7a7132d70a.png" alt="y(t=0) = 1"/>.
First the function computing the derivative of the position needs to be defined:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">calc_derivative</span><span class="p">(</span><span class="n">ypos</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>
<div class="newline"></div><span class="gp">... </span>    <span class="k">return</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">ypos</span>
<div class="newline"></div></pre></div>
</div>
<a class="reference external image-reference" href="scipy/auto_examples/plot_odeint_simple.html"><img alt="../_images/sphx_glr_plot_odeint_simple_001.png" class="align-right" src="../_images/sphx_glr_plot_odeint_simple_001.png" style="width: 280.0px; height: 210.0px;" /></a>
<p>Then, to compute <code class="docutils literal notranslate"><span class="pre">y</span></code> as a function of time:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">odeint</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">time_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">calc_derivative</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">time_vec</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<div style="clear: both"></div><p>Let us integrate a more complex ODE: a <a class="reference external" href="https://en.wikipedia.org/wiki/Harmonic_oscillator#Damped_harmonic_oscillator">damped
spring-mass oscillator</a>.
The position of a mass attached to a spring obeys the 2nd order <em>ODE</em>
<img class="math" src="../_images/math/cd1474e83f121109d421e54e8ed0ef1f8b7dbb3c.png" alt="y'' + 2 \varepsilon \omega_0  y' + \omega_0^2 y = 0"/> with
<img class="math" src="../_images/math/2c1d56810f9e764242cde46d5f2acb0760d4fb01.png" alt="\omega_0^2 = k/m"/> with <img class="math" src="../_images/math/0b7c1e16a3a8a849bb8ffdcdbf86f65fd1f30438.png" alt="k"/> the spring constant, <img class="math" src="../_images/math/edba97b4c0d864d26e92ea7ea73767fa38eef3f7.png" alt="m"/> the mass
and <img class="math" src="../_images/math/9c2310c8da009c667752c2230b76b7ba716f7820.png" alt="\varepsilon = c/(2 m \omega_0)"/> with <img class="math" src="../_images/math/ae12a24f88803b5895632e4848d87d46483c492c.png" alt="c"/> the damping coefficient. We set:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mass</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># kg</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">kspring</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># N/m</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">cviscous</span> <span class="o">=</span> <span class="mf">0.4</span>  <span class="c1"># N s/m</span>
<div class="newline"></div></pre></div>
</div>
<p>Hence:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eps</span> <span class="o">=</span> <span class="n">cviscous</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">mass</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">kspring</span><span class="o">/</span><span class="n">mass</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">omega</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">kspring</span> <span class="o">/</span> <span class="n">mass</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>The system is underdamped, as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eps</span> <span class="o">&lt;</span> <span class="mi">1</span>
<div class="newline"></div><span class="go">True</span>
<div class="newline"></div></pre></div>
</div>
<p>For <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.odeint.html#scipy.integrate.odeint" title="(in SciPy v1.9.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">odeint()</span></code></a>, the 2nd order equation
needs to be transformed in a system of two first-order equations for the
vector <img class="math" src="../_images/math/aa01f7958375460f497df8c4d2c96a7b6e2c924f.png" alt="Y = (y, y')"/>: the function computes the
velocity and acceleration:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">calc_deri</span><span class="p">(</span><span class="n">yvec</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">eps</span><span class="p">,</span> <span class="n">omega</span><span class="p">):</span>
<div class="newline"></div><span class="gp">... </span>    <span class="k">return</span> <span class="p">(</span><span class="n">yvec</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">eps</span> <span class="o">*</span> <span class="n">omega</span> <span class="o">*</span> <span class="n">yvec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span> <span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">yvec</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<div class="newline"></div></pre></div>
</div>
<a class="reference external image-reference" href="scipy/auto_examples/plot_odeint_damped_spring_mass.html"><img alt="../_images/sphx_glr_plot_odeint_damped_spring_mass_001.png" class="align-right" src="../_images/sphx_glr_plot_odeint_damped_spring_mass_001.png" style="width: 280.0px; height: 210.0px;" /></a>
<p>Integration of the system follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">time_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">yinit</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">yarr</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">calc_deri</span><span class="p">,</span> <span class="n">yinit</span><span class="p">,</span> <span class="n">time_vec</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">eps</span><span class="p">,</span> <span class="n">omega</span><span class="p">))</span>
<div class="newline"></div></pre></div>
</div>
<div style="clear: both"></div><div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last"><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.odeint.html#scipy.integrate.odeint" title="(in SciPy v1.9.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.integrate.odeint()</span></code></a> uses the LSODA (Livermore Solver for
Ordinary Differential equations with Automatic method switching for stiff
and non-stiff problems), see the <a class="reference external" href="http://people.sc.fsu.edu/~jburkardt/f77_src/odepack/odepack.html">ODEPACK Fortran library</a> for more
details.</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p><strong>Partial Differental Equations</strong></p>
<p class="last">There is no Partial Differential Equations (PDE) solver in Scipy.
Some Python packages for solving PDE’s are available, such as <a class="reference external" href="http://www.ctcms.nist.gov/fipy/">fipy</a>
or <a class="reference external" href="http://sfepy.org/doc/">SfePy</a>.</p>
</div>
</div>
</div>
<div class="section" id="fast-fourier-transforms-scipy-fftpack">
<h2><a class="toc-backref" href="#id30">1.6.8. Fast Fourier transforms: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/fftpack.html#module-scipy.fftpack" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.fftpack</span></code></a></a><a class="headerlink" href="#fast-fourier-transforms-scipy-fftpack" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/fftpack.html#module-scipy.fftpack" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.fftpack</span></code></a> module computes fast Fourier transforms (FFTs)
and offers utilities to handle them. The main functions are:</p>
<ul class="simple">
<li><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.fftpack.fft.html#scipy.fftpack.fft" title="(in SciPy v1.9.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.fftpack.fft()</span></code></a> to compute the FFT</li>
<li><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.fftpack.fftfreq.html#scipy.fftpack.fftfreq" title="(in SciPy v1.9.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.fftpack.fftfreq()</span></code></a> to generate the sampling frequencies</li>
<li><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.fftpack.ifft.html#scipy.fftpack.ifft" title="(in SciPy v1.9.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.fftpack.ifft()</span></code></a> computes the inverse FFT, from frequency
space to signal space</li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>As an illustration, a (noisy) input signal (<code class="docutils literal notranslate"><span class="pre">sig</span></code>), and its FFT:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">fftpack</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">sig_fft</span> <span class="o">=</span> <span class="n">fftpack</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">sig</span><span class="p">)</span> 
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">freqs</span> <span class="o">=</span> <span class="n">fftpack</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">sig</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">time_step</span><span class="p">)</span> 
<div class="newline"></div></pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><a class="reference external" href="scipy/auto_examples/plot_fftpack.html"><img alt="signal_fig" src="../_images/sphx_glr_plot_fftpack_001.png" style="width: 360.0px; height: 300.0px;" /></a></th>
<th class="head"><a class="reference external" href="scipy/auto_examples/plot_fftpack.html"><img alt="fft_fig" src="../_images/sphx_glr_plot_fftpack_002.png" style="width: 360.0px; height: 300.0px;" /></a></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Signal</strong></td>
<td><strong>FFT</strong></td>
</tr>
</tbody>
</table>
<p>As the signal comes from a real function, the Fourier transform is
symmetric.</p>
<p>The peak signal frequency can be found with <code class="docutils literal notranslate"><span class="pre">freqs[power.argmax()]</span></code></p>
<a class="reference external image-reference" href="scipy/auto_examples/plot_fftpack.html"><img alt="../_images/sphx_glr_plot_fftpack_003.png" class="align-right" src="../_images/sphx_glr_plot_fftpack_003.png" style="width: 360.0px; height: 300.0px;" /></a>
<p>Setting the Fourrier component above this frequency to zero and inverting
the FFT with <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.fftpack.ifft.html#scipy.fftpack.ifft" title="(in SciPy v1.9.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.fftpack.ifft()</span></code></a>, gives a filtered signal.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The code of this example can be found <a class="reference internal" href="scipy/auto_examples/plot_fftpack.html#sphx-glr-intro-scipy-auto-examples-plot-fftpack-py"><span class="std std-ref">here</span></a></p>
</div>
<div class="topic">
<p class="topic-title"><cite>numpy.fft</cite></p>
<p>Numpy also has an implementation of FFT (<a class="reference external" href="https://numpy.org/doc/stable/reference/routines.fft.html#module-numpy.fft" title="(in NumPy v1.23)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">numpy.fft</span></code></a>). However,
the scipy one
should be preferred, as it uses more efficient underlying implementations.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Fully worked examples:</strong></p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Crude periodicity finding (<a class="reference internal" href="scipy/auto_examples/solutions/plot_periodicity_finder.html#sphx-glr-intro-scipy-auto-examples-solutions-plot-periodicity-finder-py"><span class="std std-ref">link</span></a>)</th>
<th class="head">Gaussian image blur (<a class="reference internal" href="scipy/auto_examples/solutions/plot_image_blur.html#sphx-glr-intro-scipy-auto-examples-solutions-plot-image-blur-py"><span class="std std-ref">link</span></a>)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><a class="reference external" href="scipy/auto_examples/solutions/plot_periodicity_finder.html"><img alt="periodicity_finding" src="../_images/sphx_glr_plot_periodicity_finder_001.png" style="width: 320.0px; height: 240.0px;" /></a></td>
<td><a class="reference external" href="scipy/auto_examples/solutions/plot_image_blur.html"><img alt="image_blur" src="../_images/sphx_glr_plot_image_blur_002.png" style="width: 320.0px; height: 240.0px;" /></a></td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="green topic">
<p class="topic-title">Exercise: Denoise moon landing image</p>
<a class="reference internal image-reference" href="../_images/moonlanding.png"><img alt="../_images/moonlanding.png" src="../_images/moonlanding.png" style="width: 441.0px; height: 331.79999999999995px;" /></a>
<ol class="arabic simple">
<li>Examine the provided image <a class="reference download internal" href="../_downloads/moonlanding.png" download=""><code class="xref download docutils literal notranslate"><span class="pre">moonlanding.png</span></code></a>, which is heavily contaminated with periodic
noise. In this exercise, we aim to clean up the noise using the
Fast Fourier Transform.</li>
<li>Load the image using <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imread.html#matplotlib.pyplot.imread" title="(in Matplotlib v3.5.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">matplotlib.pyplot.imread()</span></code></a>.</li>
<li>Find and use the 2-D FFT function in <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/fftpack.html#module-scipy.fftpack" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.fftpack</span></code></a>, and plot the
spectrum (Fourier transform of) the image. Do you have any trouble
visualising the spectrum? If so, why?</li>
<li>The spectrum consists of high and low frequency components. The noise is
contained in the high-frequency part of the spectrum, so set some of
those components to zero (use array slicing).</li>
<li>Apply the inverse Fourier transform to see the resulting image.</li>
</ol>
<p><a class="reference internal" href="scipy/auto_examples/solutions/plot_fft_image_denoise.html#sphx-glr-intro-scipy-auto-examples-solutions-plot-fft-image-denoise-py"><span class="std std-ref">Solution</span></a></p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="signal-processing-scipy-signal">
<h2><a class="toc-backref" href="#id31">1.6.9. Signal processing: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/signal.html#module-scipy.signal" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.signal</span></code></a></a><a class="headerlink" href="#signal-processing-scipy-signal" title="Permalink to this headline">¶</a></h2>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last"><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/signal.html#module-scipy.signal" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.signal</span></code></a> is for typical signal processing: 1D,
regularly-sampled signals.</p>
</div>
<a class="reference external image-reference" href="scipy/auto_examples/plot_resample.html"><img alt="../_images/sphx_glr_plot_resample_001.png" class="align-right" src="../_images/sphx_glr_plot_resample_001.png" style="width: 325.0px; height: 260.0px;" /></a>
<p><strong>Resampling</strong> <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.resample.html#scipy.signal.resample" title="(in SciPy v1.9.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.signal.resample()</span></code></a>: resample a signal to <cite>n</cite>
points using FFT.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">x_resampled</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> 
<div class="newline"></div><span class="go">[&lt;matplotlib.lines.Line2D object at ...&gt;]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[::</span><span class="mi">4</span><span class="p">],</span> <span class="n">x_resampled</span><span class="p">,</span> <span class="s1">&#39;ko&#39;</span><span class="p">)</span> 
<div class="newline"></div><span class="go">[&lt;matplotlib.lines.Line2D object at ...&gt;]</span>
<div class="newline"></div></pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>Notice how on the side of the window the resampling is less accurate
and has a rippling effect.</p>
<p class="last">This resampling is different from the <a class="reference internal" href="#intro-scipy-interpolate"><span class="std std-ref">interpolation</span></a> provided by <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/interpolate.html#module-scipy.interpolate" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.interpolate</span></code></a> as it
only applies to regularly sampled data.</p>
</div>
<a class="reference external image-reference" href="scipy/auto_examples/plot_detrend.html"><img alt="../_images/sphx_glr_plot_detrend_001.png" class="align-right" src="../_images/sphx_glr_plot_detrend_001.png" style="width: 325.0px; height: 260.0px;" /></a>
<p><strong>Detrending</strong> <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.detrend.html#scipy.signal.detrend" title="(in SciPy v1.9.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.signal.detrend()</span></code></a>: remove linear trend from signal:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">x_detrended</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">detrend</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> 
<div class="newline"></div><span class="go">[&lt;matplotlib.lines.Line2D object at ...&gt;]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x_detrended</span><span class="p">)</span> 
<div class="newline"></div><span class="go">[&lt;matplotlib.lines.Line2D object at ...&gt;]</span>
<div class="newline"></div></pre></div>
</div>
<div style="clear: both"></div><p><strong>Filtering</strong>:
For non-linear filtering, <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/signal.html#module-scipy.signal" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.signal</span></code></a> has filtering (median
filter <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.medfilt.html#scipy.signal.medfilt" title="(in SciPy v1.9.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.signal.medfilt()</span></code></a>, Wiener <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.wiener.html#scipy.signal.wiener" title="(in SciPy v1.9.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.signal.wiener()</span></code></a>),
but we will discuss this in the image section.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last"><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/signal.html#module-scipy.signal" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.signal</span></code></a> also has a full-blown set of tools for the design
of linear filter (finite and infinite response filters), but this is
out of the scope of this tutorial.</p>
</div>
<p><strong>Spectral analysis</strong>:
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.spectrogram.html#scipy.signal.spectrogram" title="(in SciPy v1.9.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.signal.spectrogram()</span></code></a> compute a spectrogram –frequency
spectrums over consecutive time windows–, while
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.welch.html#scipy.signal.welch" title="(in SciPy v1.9.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.signal.welch()</span></code></a> comptes a power spectrum density (PSD).</p>
<p><a class="reference external" href="scipy/auto_examples/plot_spectrogram.html"><img alt="chirp_fig" src="../_images/sphx_glr_plot_spectrogram_001.png" style="width: 360.0px; height: 225.0px;" /></a> <a class="reference external" href="scipy/auto_examples/plot_spectrogram.html"><img alt="spectrogram_fig" src="../_images/sphx_glr_plot_spectrogram_002.png" style="width: 225.0px; height: 180.0px;" /></a> <a class="reference external" href="scipy/auto_examples/plot_spectrogram.html"><img alt="psd_fig" src="../_images/sphx_glr_plot_spectrogram_003.png" style="width: 225.0px; height: 180.0px;" /></a></p>
</div>
<div class="section" id="image-manipulation-scipy-ndimage">
<h2><a class="toc-backref" href="#id32">1.6.10. Image manipulation: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/ndimage.html#module-scipy.ndimage" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.ndimage</span></code></a></a><a class="headerlink" href="#image-manipulation-scipy-ndimage" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/ndimage.html#module-scipy.ndimage" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.ndimage</span></code></a> provides manipulation of n-dimensional arrays as
images.</p>
<div class="section" id="geometrical-transformations-on-images">
<h3>1.6.10.1. Geometrical transformations on images<a class="headerlink" href="#geometrical-transformations-on-images" title="Permalink to this headline">¶</a></h3>
<p>Changing orientation, resolution, ..</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">misc</span>  <span class="c1"># Load an image</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">face</span> <span class="o">=</span> <span class="n">misc</span><span class="o">.</span><span class="n">face</span><span class="p">(</span><span class="n">gray</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">ndimage</span> <span class="c1"># Shift, roate and zoom it</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">shifted_face</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">face</span><span class="p">,</span> <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">shifted_face2</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">face</span><span class="p">,</span> <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">rotated_face</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">face</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">cropped_face</span> <span class="o">=</span> <span class="n">face</span><span class="p">[</span><span class="mi">50</span><span class="p">:</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">:</span><span class="o">-</span><span class="mi">50</span><span class="p">]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">zoomed_face</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">zoom</span><span class="p">(</span><span class="n">face</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">zoomed_face</span><span class="o">.</span><span class="n">shape</span>
<div class="newline"></div><span class="go">(1536, 2048)</span>
<div class="newline"></div></pre></div>
</div>
<a class="reference external image-reference" href="scipy/auto_examples/plot_image_transform.html"><img alt="../_images/sphx_glr_plot_image_transform_001.png" class="align-center" src="../_images/sphx_glr_plot_image_transform_001.png" style="width: 1050.0px; height: 210.0px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">151</span><span class="p">)</span>    
<div class="newline"></div><span class="go">&lt;matplotlib.axes._subplots.AxesSubplot object at 0x...&gt;</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">shifted_face</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gray</span><span class="p">)</span>    
<div class="newline"></div><span class="go">&lt;matplotlib.image.AxesImage object at 0x...&gt;</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<div class="newline"></div><span class="go">(-0.5, 1023.5, 767.5, -0.5)</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="c1"># etc.</span>
<div class="newline"></div></pre></div>
</div>
</div>
<div class="section" id="image-filtering">
<h3>1.6.10.2. Image filtering<a class="headerlink" href="#image-filtering" title="Permalink to this headline">¶</a></h3>
<p>Generate a noisy face:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">misc</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">face</span> <span class="o">=</span> <span class="n">misc</span><span class="o">.</span><span class="n">face</span><span class="p">(</span><span class="n">gray</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">face</span> <span class="o">=</span> <span class="n">face</span><span class="p">[:</span><span class="mi">512</span><span class="p">,</span> <span class="o">-</span><span class="mi">512</span><span class="p">:]</span>  <span class="c1"># crop out square on right</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">noisy_face</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">face</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">noisy_face</span> <span class="o">+=</span> <span class="n">face</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="n">face</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>Apply a variety of filters on it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">blurred_face</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">gaussian_filter</span><span class="p">(</span><span class="n">noisy_face</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">median_face</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">median_filter</span><span class="p">(</span><span class="n">noisy_face</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">wiener_face</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">wiener</span><span class="p">(</span><span class="n">noisy_face</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<div class="newline"></div></pre></div>
</div>
<a class="reference external image-reference" href="scipy/auto_examples/plot_image_filters.html"><img alt="../_images/sphx_glr_plot_image_filters_001.png" class="align-center" src="../_images/sphx_glr_plot_image_filters_001.png" style="width: 840.0px; height: 244.99999999999997px;" /></a>
<p>Other filters in <code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.ndimage.filters</span></code> and <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/signal.html#module-scipy.signal" title="(in SciPy v1.9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.signal</span></code></a>
can be applied to images.</p>
<div class="green topic">
<p class="topic-title">Exercise</p>
<blockquote>
<div>Compare histograms for the different filtered images.</div></blockquote>
</div>
</div>
<div class="section" id="mathematical-morphology">
<h3>1.6.10.3. Mathematical morphology<a class="headerlink" href="#mathematical-morphology" title="Permalink to this headline">¶</a></h3>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last"><a class="reference external" href="https://en.wikipedia.org/wiki/Mathematical_morphology">Mathematical morphology</a> stems from set
theory. It characterizes and transforms geometrical structures. Binary
(black and white) images, in particular, can be transformed using this
theory: the sets to be transformed are the sets of neighboring
non-zero-valued pixels. The theory was also extended to gray-valued
images.</p>
</div>
<img alt="../_images/morpho_mat1.png" class="align-center" src="../_images/morpho_mat1.png" />
<p>Mathematical-morphology operations use a <em>structuring element</em>
in order to modify geometrical structures.</p>
<p>Let us first generate a structuring element:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">el</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">generate_binary_structure</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">el</span> 
<div class="newline"></div><span class="go">array([[False, True, False],</span>
<div class="newline"></div><span class="go">       [...True, True, True],</span>
<div class="newline"></div><span class="go">       [False, True, False]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">el</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
<div class="newline"></div><span class="go">array([[0, 1, 0],</span>
<div class="newline"></div><span class="go">       [1, 1, 1],</span>
<div class="newline"></div><span class="go">       [0, 1, 0]])</span>
<div class="newline"></div></pre></div>
</div>
<ul>
<li><p class="first"><strong>Erosion</strong> <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.ndimage.binary_erosion.html#scipy.ndimage.binary_erosion" title="(in SciPy v1.9.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.ndimage.binary_erosion()</span></code></a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<div class="newline"></div><span class="go">array([[0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_erosion</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<div class="newline"></div><span class="go">array([[0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 1, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 1, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 1, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="c1">#Erosion removes objects smaller than the structure</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_erosion</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<div class="newline"></div><span class="go">array([[0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0]])</span>
<div class="newline"></div></pre></div>
</div>
</li>
<li><p class="first"><strong>Dilation</strong> <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.ndimage.binary_dilation.html#scipy.ndimage.binary_dilation" title="(in SciPy v1.9.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.ndimage.binary_dilation()</span></code></a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<div class="newline"></div><span class="go">array([[0.,  0.,  0.,  0.,  0.],</span>
<div class="newline"></div><span class="go">       [0.,  0.,  0.,  0.,  0.],</span>
<div class="newline"></div><span class="go">       [0.,  0.,  1.,  0.,  0.],</span>
<div class="newline"></div><span class="go">       [0.,  0.,  0.,  0.,  0.],</span>
<div class="newline"></div><span class="go">       [0.,  0.,  0.,  0.,  0.]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_dilation</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<div class="newline"></div><span class="go">array([[0.,  0.,  0.,  0.,  0.],</span>
<div class="newline"></div><span class="go">       [0.,  0.,  1.,  0.,  0.],</span>
<div class="newline"></div><span class="go">       [0.,  1.,  1.,  1.,  0.],</span>
<div class="newline"></div><span class="go">       [0.,  0.,  1.,  0.,  0.],</span>
<div class="newline"></div><span class="go">       [0.,  0.,  0.,  0.,  0.]])</span>
<div class="newline"></div></pre></div>
</div>
</li>
<li><p class="first"><strong>Opening</strong> <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.ndimage.binary_opening.html#scipy.ndimage.binary_opening" title="(in SciPy v1.9.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.ndimage.binary_opening()</span></code></a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<div class="newline"></div><span class="go">array([[0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 1, 1, 1, 0],</span>
<div class="newline"></div><span class="go">       [0, 1, 1, 1, 0],</span>
<div class="newline"></div><span class="go">       [0, 1, 1, 1, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 1]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Opening removes small objects</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_opening</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
<div class="newline"></div><span class="go">array([[0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 1, 1, 1, 0],</span>
<div class="newline"></div><span class="go">       [0, 1, 1, 1, 0],</span>
<div class="newline"></div><span class="go">       [0, 1, 1, 1, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Opening can also smooth corners</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_opening</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
<div class="newline"></div><span class="go">array([[0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 1, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 1, 1, 1, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 1, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0]])</span>
<div class="newline"></div></pre></div>
</div>
</li>
<li><p class="first"><strong>Closing:</strong> <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.ndimage.binary_closing.html#scipy.ndimage.binary_closing" title="(in SciPy v1.9.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.ndimage.binary_closing()</span></code></a></p>
</li>
</ul>
<div class="green topic">
<p class="topic-title">Exercise</p>
<blockquote>
<div>Check that opening amounts to eroding, then dilating.</div></blockquote>
</div>
<p>An opening operation removes small structures, while a closing operation
fills small holes. Such operations can therefore be used to “clean” an
image.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span><span class="o">-</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">+=</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="n">a</span><span class="o">&gt;=</span><span class="mf">0.5</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">opened_mask</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">binary_opening</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">closed_mask</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">binary_closing</span><span class="p">(</span><span class="n">opened_mask</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<a class="reference external image-reference" href="scipy/auto_examples/plot_mathematical_morpho.html"><img alt="../_images/sphx_glr_plot_mathematical_morpho_001.png" class="align-center" src="../_images/sphx_glr_plot_mathematical_morpho_001.png" style="width: 840.0px; height: 244.99999999999997px;" /></a>
<div class="green topic">
<p class="topic-title">Exercise</p>
<blockquote>
<div>Check that the area of the reconstructed square is smaller
than the area of the initial square. (The opposite would occur if the
closing step was performed <em>before</em> the opening).</div></blockquote>
</div>
<p>For <em>gray-valued</em> images, eroding (resp. dilating) amounts to replacing
a pixel by the minimal (resp. maximal) value among pixels covered by the
structuring element centered on the pixel of interest.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<div class="newline"></div><span class="go">array([[0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 3, 3, 3, 3, 3, 0],</span>
<div class="newline"></div><span class="go">       [0, 3, 3, 1, 3, 3, 0],</span>
<div class="newline"></div><span class="go">       [0, 3, 3, 3, 3, 3, 0],</span>
<div class="newline"></div><span class="go">       [0, 3, 3, 3, 2, 3, 0],</span>
<div class="newline"></div><span class="go">       [0, 3, 3, 3, 3, 3, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">grey_erosion</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<div class="newline"></div><span class="go">array([[0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 3, 2, 2, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0]])</span>
<div class="newline"></div></pre></div>
</div>
</div>
<div class="section" id="connected-components-and-measurements-on-images">
<h3>1.6.10.4. Connected components and measurements on images<a class="headerlink" href="#connected-components-and-measurements-on-images" title="Permalink to this headline">¶</a></h3>
<p>Let us first generate a nice synthetic binary image.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">indices</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">sig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="mf">50.</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">y</span><span class="o">/</span><span class="mf">50.</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">/</span><span class="mf">50.</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="n">sig</span> <span class="o">&gt;</span> <span class="mi">1</span>
<div class="newline"></div></pre></div>
</div>
<a class="reference external image-reference" href="scipy/auto_examples/plot_connect_measurements.html"><img alt="../_images/sphx_glr_plot_connect_measurements_001.png" class="align-center" src="../_images/sphx_glr_plot_connect_measurements_001.png" style="width: 420.0px; height: 210.0px;" /></a>
<a class="reference external image-reference" href="scipy/auto_examples/plot_connect_measurements.html"><img alt="../_images/sphx_glr_plot_connect_measurements_002.png" class="align-right" src="../_images/sphx_glr_plot_connect_measurements_002.png" style="width: 210.0px; height: 210.0px;" /></a>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.ndimage.label.html#scipy.ndimage.label" title="(in SciPy v1.9.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.ndimage.label()</span></code></a> assigns a different label to each connected
component:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span><span class="p">,</span> <span class="n">nb</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">nb</span>
<div class="newline"></div><span class="go">8</span>
<div class="newline"></div></pre></div>
</div>
<div style="clear: both"></div><p>Now compute measurements on each connected component:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">areas</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">labels</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">areas</span>   <span class="c1"># The number of pixels in each connected component</span>
<div class="newline"></div><span class="go">array([190.,   45.,  424.,  278.,  459.,  190.,  549.,  424.])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">maxima</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">labels</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">maxima</span>  <span class="c1"># The maximum signal in each connected component</span>
<div class="newline"></div><span class="go">array([ 1.80238238,   1.13527605,   5.51954079,   2.49611818, 6.71673619,</span>
<div class="newline"></div><span class="go">        1.80238238,  16.76547217,   5.51954079])</span>
<div class="newline"></div></pre></div>
</div>
<a class="reference external image-reference" href="scipy/auto_examples/plot_connect_measurements.html"><img alt="../_images/sphx_glr_plot_connect_measurements_003.png" class="align-right" src="../_images/sphx_glr_plot_connect_measurements_003.png" style="width: 210.0px; height: 210.0px;" /></a>
<p>Extract the 4th connected component, and crop the array around it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">find_objects</span><span class="p">(</span><span class="n">labels</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span> 
<div class="newline"></div><span class="go">[(slice(30L, 48L, None), slice(30L, 48L, None))]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">sl</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">find_objects</span><span class="p">(</span><span class="n">labels</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">sig</span><span class="p">[</span><span class="n">sl</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>   
<div class="newline"></div><span class="go">&lt;matplotlib.image.AxesImage object at ...&gt;</span>
<div class="newline"></div></pre></div>
</div>
<p>See the summary exercise on <a class="reference internal" href="summary-exercises/image-processing.html#summary-exercise-image-processing"><span class="std std-ref">Image processing application: counting bubbles and unmolten grains</span></a> for a more
advanced example.</p>
</div>
</div>
<div class="section" id="summary-exercises-on-scientific-computing">
<h2><a class="toc-backref" href="#id33">1.6.11. Summary exercises on scientific computing</a><a class="headerlink" href="#summary-exercises-on-scientific-computing" title="Permalink to this headline">¶</a></h2>
<p>The summary exercises use mainly Numpy, Scipy and Matplotlib. They provide some
real-life examples of scientific computing with Python. Now that the basics of
working with Numpy and Scipy have been introduced, the interested user is
invited to try these exercises.</p>
<p><strong>Exercises:</strong></p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="summary-exercises/stats-interpolate.html">1.6.11.1. Maximum wind speed prediction at the Sprogø station</a></li>
<li class="toctree-l1"><a class="reference internal" href="summary-exercises/optimize-fit.html">1.6.11.2. Non linear least squares curve fitting: application to point extraction in topographical lidar data</a></li>
<li class="toctree-l1"><a class="reference internal" href="summary-exercises/image-processing.html">1.6.11.3. Image processing application: counting bubbles and unmolten grains</a></li>
</ul>
</div>
<p><strong>Proposed solutions:</strong></p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="summary-exercises/answers_image_processing.html">1.6.11.4. Example of solution for the image processing exercise: unmolten grains in glass</a></li>
</ul>
</div>
</div>
<div class="section" id="full-code-examples-for-the-scipy-chapter">
<h2><a class="toc-backref" href="#id34">1.6.12. Full code examples for the scipy chapter</a><a class="headerlink" href="#full-code-examples-for-the-scipy-chapter" title="Permalink to this headline">¶</a></h2>
<div class="sphx-glr-thumbcontainer" tooltip="Demos various methods to find the minimum of a function. "><div class="figure" id="id2">
<img alt="../_images/sphx_glr_plot_optimize_example1_thumb.png" src="../_images/sphx_glr_plot_optimize_example1_thumb.png" />
<p class="caption"><span class="caption-text"><a class="reference internal" href="scipy/auto_examples/plot_optimize_example1.html#sphx-glr-intro-scipy-auto-examples-plot-optimize-example1-py"><span class="std std-ref">Finding the minimum of a smooth function</span></a></span></p>
</div>
</div><div class="toctree-wrapper compound">
</div>
<div class="sphx-glr-thumbcontainer" tooltip=":func:`scipy.signal.detrend` removes a linear trend. "><div class="figure" id="id3">
<img alt="../_images/sphx_glr_plot_detrend_thumb.png" src="../_images/sphx_glr_plot_detrend_thumb.png" />
<p class="caption"><span class="caption-text"><a class="reference internal" href="scipy/auto_examples/plot_detrend.html#sphx-glr-intro-scipy-auto-examples-plot-detrend-py"><span class="std std-ref">Detrending a signal</span></a></span></p>
</div>
</div><div class="toctree-wrapper compound">
</div>
<div class="sphx-glr-thumbcontainer" tooltip=":func:`scipy.signal.resample` uses FFT to resample a 1D signal. "><div class="figure" id="id4">
<img alt="../_images/sphx_glr_plot_resample_thumb.png" src="../_images/sphx_glr_plot_resample_thumb.png" />
<p class="caption"><span class="caption-text"><a class="reference internal" href="scipy/auto_examples/plot_resample.html#sphx-glr-intro-scipy-auto-examples-plot-resample-py"><span class="std std-ref">Resample a signal with scipy.signal.resample</span></a></span></p>
</div>
</div><div class="toctree-wrapper compound">
</div>
<div class="sphx-glr-thumbcontainer" tooltip="Solve the ODE dy/dt = -2y between t = 0..4, with the initial condition y(t=0) = 1. "><div class="figure" id="id5">
<img alt="../_images/sphx_glr_plot_odeint_simple_thumb.png" src="../_images/sphx_glr_plot_odeint_simple_thumb.png" />
<p class="caption"><span class="caption-text"><a class="reference internal" href="scipy/auto_examples/plot_odeint_simple.html#sphx-glr-intro-scipy-auto-examples-plot-odeint-simple-py"><span class="std std-ref">Integrating a simple ODE</span></a></span></p>
</div>
</div><div class="toctree-wrapper compound">
</div>
<div class="sphx-glr-thumbcontainer" tooltip="Comparing 2 sets of samples from Gaussians"><div class="figure" id="id6">
<img alt="../_images/sphx_glr_plot_t_test_thumb.png" src="../_images/sphx_glr_plot_t_test_thumb.png" />
<p class="caption"><span class="caption-text"><a class="reference internal" href="scipy/auto_examples/plot_t_test.html#sphx-glr-intro-scipy-auto-examples-plot-t-test-py"><span class="std std-ref">Comparing 2 sets of samples from Gaussians</span></a></span></p>
</div>
</div><div class="toctree-wrapper compound">
</div>
<div class="sphx-glr-thumbcontainer" tooltip=" "><div class="figure" id="id7">
<img alt="../_images/sphx_glr_plot_odeint_damped_spring_mass_thumb.png" src="../_images/sphx_glr_plot_odeint_damped_spring_mass_thumb.png" />
<p class="caption"><span class="caption-text"><a class="reference internal" href="scipy/auto_examples/plot_odeint_damped_spring_mass.html#sphx-glr-intro-scipy-auto-examples-plot-odeint-damped-spring-mass-py"><span class="std std-ref">Integrate the Damped spring-mass oscillator</span></a></span></p>
</div>
</div><div class="toctree-wrapper compound">
</div>
<div class="sphx-glr-thumbcontainer" tooltip="Explore the normal distribution: a histogram built from samples and the PDF (probability densit..."><div class="figure" id="id8">
<img alt="../_images/sphx_glr_plot_normal_distribution_thumb.png" src="../_images/sphx_glr_plot_normal_distribution_thumb.png" />
<p class="caption"><span class="caption-text"><a class="reference internal" href="scipy/auto_examples/plot_normal_distribution.html#sphx-glr-intro-scipy-auto-examples-plot-normal-distribution-py"><span class="std std-ref">Normal distribution: histogram and PDF</span></a></span></p>
</div>
</div><div class="toctree-wrapper compound">
</div>
<div class="sphx-glr-thumbcontainer" tooltip="Demos a simple curve fitting "><div class="figure" id="id9">
<img alt="../_images/sphx_glr_plot_curve_fit_thumb.png" src="../_images/sphx_glr_plot_curve_fit_thumb.png" />
<p class="caption"><span class="caption-text"><a class="reference internal" href="scipy/auto_examples/plot_curve_fit.html#sphx-glr-intro-scipy-auto-examples-plot-curve-fit-py"><span class="std std-ref">Curve fitting</span></a></span></p>
</div>
</div><div class="toctree-wrapper compound">
</div>
<div class="sphx-glr-thumbcontainer" tooltip="Demo spectrogram and power spectral density on a frequency chirp. "><div class="figure" id="id10">
<img alt="../_images/sphx_glr_plot_spectrogram_thumb.png" src="../_images/sphx_glr_plot_spectrogram_thumb.png" />
<p class="caption"><span class="caption-text"><a class="reference internal" href="scipy/auto_examples/plot_spectrogram.html#sphx-glr-intro-scipy-auto-examples-plot-spectrogram-py"><span class="std std-ref">Spectrogram, power spectral density</span></a></span></p>
</div>
</div><div class="toctree-wrapper compound">
</div>
<div class="sphx-glr-thumbcontainer" tooltip="A demo of 1D interpolation"><div class="figure" id="id11">
<img alt="../_images/sphx_glr_plot_interpolation_thumb.png" src="../_images/sphx_glr_plot_interpolation_thumb.png" />
<p class="caption"><span class="caption-text"><a class="reference internal" href="scipy/auto_examples/plot_interpolation.html#sphx-glr-intro-scipy-auto-examples-plot-interpolation-py"><span class="std std-ref">A demo of 1D interpolation</span></a></span></p>
</div>
</div><div class="toctree-wrapper compound">
</div>
<div class="sphx-glr-thumbcontainer" tooltip="A basic demo of binary opening and closing. "><div class="figure" id="id12">
<img alt="../_images/sphx_glr_plot_mathematical_morpho_thumb.png" src="../_images/sphx_glr_plot_mathematical_morpho_thumb.png" />
<p class="caption"><span class="caption-text"><a class="reference internal" href="scipy/auto_examples/plot_mathematical_morpho.html#sphx-glr-intro-scipy-auto-examples-plot-mathematical-morpho-py"><span class="std std-ref">Demo mathematical morphology</span></a></span></p>
</div>
</div><div class="toctree-wrapper compound">
</div>
<div class="sphx-glr-thumbcontainer" tooltip="Demo geometrical transformations of images. "><div class="figure" id="id13">
<img alt="../_images/sphx_glr_plot_image_transform_thumb.png" src="../_images/sphx_glr_plot_image_transform_thumb.png" />
<p class="caption"><span class="caption-text"><a class="reference internal" href="scipy/auto_examples/plot_image_transform.html#sphx-glr-intro-scipy-auto-examples-plot-image-transform-py"><span class="std std-ref">Plot geometrical transformations on images</span></a></span></p>
</div>
</div><div class="toctree-wrapper compound">
</div>
<div class="sphx-glr-thumbcontainer" tooltip="Extracting and labeling connected components in a 2D array "><div class="figure" id="id14">
<img alt="../_images/sphx_glr_plot_connect_measurements_thumb.png" src="../_images/sphx_glr_plot_connect_measurements_thumb.png" />
<p class="caption"><span class="caption-text"><a class="reference internal" href="scipy/auto_examples/plot_connect_measurements.html#sphx-glr-intro-scipy-auto-examples-plot-connect-measurements-py"><span class="std std-ref">Demo connected components</span></a></span></p>
</div>
</div><div class="toctree-wrapper compound">
</div>
<div class="sphx-glr-thumbcontainer" tooltip="Demos finding minima and roots of a function. "><div class="figure" id="id15">
<img alt="../_images/sphx_glr_plot_optimize_example2_thumb.png" src="../_images/sphx_glr_plot_optimize_example2_thumb.png" />
<p class="caption"><span class="caption-text"><a class="reference internal" href="scipy/auto_examples/plot_optimize_example2.html#sphx-glr-intro-scipy-auto-examples-plot-optimize-example2-py"><span class="std std-ref">Minima and roots of a function</span></a></span></p>
</div>
</div><div class="toctree-wrapper compound">
</div>
<div class="sphx-glr-thumbcontainer" tooltip="Demo filtering for denoising of images. "><div class="figure" id="id16">
<img alt="../_images/sphx_glr_plot_image_filters_thumb.png" src="../_images/sphx_glr_plot_image_filters_thumb.png" />
<p class="caption"><span class="caption-text"><a class="reference internal" href="scipy/auto_examples/plot_image_filters.html#sphx-glr-intro-scipy-auto-examples-plot-image-filters-py"><span class="std std-ref">Plot filtering on images</span></a></span></p>
</div>
</div><div class="toctree-wrapper compound">
</div>
<div class="sphx-glr-thumbcontainer" tooltip="Optimization of a two"><div class="figure" id="id17">
<img alt="../_images/sphx_glr_plot_2d_minimization_thumb.png" src="../_images/sphx_glr_plot_2d_minimization_thumb.png" />
<p class="caption"><span class="caption-text"><a class="reference internal" href="scipy/auto_examples/plot_2d_minimization.html#sphx-glr-intro-scipy-auto-examples-plot-2d-minimization-py"><span class="std std-ref">Optimization of a two-parameter function</span></a></span></p>
</div>
</div><div class="toctree-wrapper compound">
</div>
<div class="sphx-glr-thumbcontainer" tooltip="Plot the power of the FFT of a signal and inverse FFT back to reconstruct a signal."><div class="figure" id="id18">
<img alt="../_images/sphx_glr_plot_fftpack_thumb.png" src="../_images/sphx_glr_plot_fftpack_thumb.png" />
<p class="caption"><span class="caption-text"><a class="reference internal" href="scipy/auto_examples/plot_fftpack.html#sphx-glr-intro-scipy-auto-examples-plot-fftpack-py"><span class="std std-ref">Plotting and manipulating FFTs for filtering</span></a></span></p>
</div>
</div><div class="toctree-wrapper compound">
</div>
<div style='clear:both'></div><div class="section" id="solutions-of-the-exercises-for-scipy">
<h3>1.6.12.18. Solutions of the exercises for scipy<a class="headerlink" href="#solutions-of-the-exercises-for-scipy" title="Permalink to this headline">¶</a></h3>
<div class="sphx-glr-thumbcontainer" tooltip="Discover the periods in evolution of animal populations (:download:`../../../../data/population..."><div class="figure" id="id19">
<img alt="../_images/sphx_glr_plot_periodicity_finder_thumb.png" src="../_images/sphx_glr_plot_periodicity_finder_thumb.png" />
<p class="caption"><span class="caption-text"><a class="reference internal" href="scipy/auto_examples/solutions/plot_periodicity_finder.html#sphx-glr-intro-scipy-auto-examples-solutions-plot-periodicity-finder-py"><span class="std std-ref">Crude periodicity finding</span></a></span></p>
</div>
</div><div class="toctree-wrapper compound">
</div>
<div class="sphx-glr-thumbcontainer" tooltip="We have the min and max temperatures in Alaska for each months of the year. We would like to fi..."><div class="figure" id="id20">
<img alt="../_images/sphx_glr_plot_curvefit_temperature_data_thumb.png" src="../_images/sphx_glr_plot_curvefit_temperature_data_thumb.png" />
<p class="caption"><span class="caption-text"><a class="reference internal" href="scipy/auto_examples/solutions/plot_curvefit_temperature_data.html#sphx-glr-intro-scipy-auto-examples-solutions-plot-curvefit-temperature-data-py"><span class="std std-ref">Curve fitting: temperature as a function of month of the year</span></a></span></p>
</div>
</div><div class="toctree-wrapper compound">
</div>
<div class="sphx-glr-thumbcontainer" tooltip="Blur an an image (:download:`../../../../data/elephant.png`) using a Gaussian kernel."><div class="figure" id="id21">
<img alt="../_images/sphx_glr_plot_image_blur_thumb.png" src="../_images/sphx_glr_plot_image_blur_thumb.png" />
<p class="caption"><span class="caption-text"><a class="reference internal" href="scipy/auto_examples/solutions/plot_image_blur.html#sphx-glr-intro-scipy-auto-examples-solutions-plot-image-blur-py"><span class="std std-ref">Simple image blur by convolution with a Gaussian kernel</span></a></span></p>
</div>
</div><div class="toctree-wrapper compound">
</div>
<div class="sphx-glr-thumbcontainer" tooltip="Denoise an image (:download:`../../../../data/moonlanding.png`) by implementing a blur with an ..."><div class="figure" id="id22">
<img alt="../_images/sphx_glr_plot_fft_image_denoise_thumb.png" src="../_images/sphx_glr_plot_fft_image_denoise_thumb.png" />
<p class="caption"><span class="caption-text"><a class="reference internal" href="scipy/auto_examples/solutions/plot_fft_image_denoise.html#sphx-glr-intro-scipy-auto-examples-solutions-plot-fft-image-denoise-py"><span class="std std-ref">Image denoising by FFT</span></a></span></p>
</div>
</div><div class="toctree-wrapper compound">
</div>
<div style='clear:both'></div><div class="sphx-glr-footer class sphx-glr-footer-gallery docutils container">
<div class="sphx-glr-download docutils container">
<a class="reference download internal" href="../_downloads/auto_examples_python6.zip" download=""><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">all</span> <span class="pre">examples</span> <span class="pre">in</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">auto_examples_python.zip</span></code></a></div>
<div class="sphx-glr-download docutils container">
<a class="reference download internal" href="../_downloads/auto_examples_jupyter6.zip" download=""><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">all</span> <span class="pre">examples</span> <span class="pre">in</span> <span class="pre">Jupyter</span> <span class="pre">notebooks:</span> <span class="pre">auto_examples_jupyter.zip</span></code></a></div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.readthedocs.io">Gallery generated by Sphinx-Gallery</a></p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p><strong>References to go further</strong></p>
<ul class="last simple">
<li>Some chapters of the <a class="reference external" href="advanced_topics_part">advanced</a> and the
<a class="reference external" href="applications_part">packages and applications</a> parts of the scipy
lectures</li>
<li>The <a class="reference external" href="http://scipy-cookbook.readthedocs.io">scipy cookbook</a></li>
</ul>
</div>
<p><div style="clear: both"></div></p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">1.6. Scipy : high-level scientific computing</a><ul>
<li><a class="reference internal" href="#file-input-output-scipy-io">1.6.1. File input/output: <code class="docutils literal notranslate"><span class="pre">scipy.io</span></code></a></li>
<li><a class="reference internal" href="#special-functions-scipy-special">1.6.2. Special functions: <code class="docutils literal notranslate"><span class="pre">scipy.special</span></code></a></li>
<li><a class="reference internal" href="#linear-algebra-operations-scipy-linalg">1.6.3. Linear algebra operations: <code class="docutils literal notranslate"><span class="pre">scipy.linalg</span></code></a></li>
<li><a class="reference internal" href="#interpolation-scipy-interpolate">1.6.4. Interpolation: <code class="docutils literal notranslate"><span class="pre">scipy.interpolate</span></code></a></li>
<li><a class="reference internal" href="#optimization-and-fit-scipy-optimize">1.6.5. Optimization and fit: <code class="docutils literal notranslate"><span class="pre">scipy.optimize</span></code></a><ul>
<li><a class="reference internal" href="#curve-fitting">1.6.5.1. Curve fitting</a></li>
<li><a class="reference internal" href="#finding-the-minimum-of-a-scalar-function">1.6.5.2. Finding the minimum of a scalar function</a></li>
<li><a class="reference internal" href="#finding-the-roots-of-a-scalar-function">1.6.5.3. Finding the roots of a scalar function</a></li>
</ul>
</li>
<li><a class="reference internal" href="#statistics-and-random-numbers-scipy-stats">1.6.6. Statistics and random numbers: <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code></a><ul>
<li><a class="reference internal" href="#distributions-histogram-and-probability-density-function">1.6.6.1. Distributions: histogram and probability density function</a></li>
<li><a class="reference internal" href="#mean-median-and-percentiles">1.6.6.2. Mean, median and percentiles</a></li>
<li><a class="reference internal" href="#statistical-tests">1.6.6.3. Statistical tests</a></li>
</ul>
</li>
<li><a class="reference internal" href="#numerical-integration-scipy-integrate">1.6.7. Numerical integration: <code class="docutils literal notranslate"><span class="pre">scipy.integrate</span></code></a><ul>
<li><a class="reference internal" href="#function-integrals">1.6.7.1. Function integrals</a></li>
<li><a class="reference internal" href="#integrating-differential-equations">1.6.7.2. Integrating differential equations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#fast-fourier-transforms-scipy-fftpack">1.6.8. Fast Fourier transforms: <code class="docutils literal notranslate"><span class="pre">scipy.fftpack</span></code></a></li>
<li><a class="reference internal" href="#signal-processing-scipy-signal">1.6.9. Signal processing: <code class="docutils literal notranslate"><span class="pre">scipy.signal</span></code></a></li>
<li><a class="reference internal" href="#image-manipulation-scipy-ndimage">1.6.10. Image manipulation: <code class="docutils literal notranslate"><span class="pre">scipy.ndimage</span></code></a><ul>
<li><a class="reference internal" href="#geometrical-transformations-on-images">1.6.10.1. Geometrical transformations on images</a></li>
<li><a class="reference internal" href="#image-filtering">1.6.10.2. Image filtering</a></li>
<li><a class="reference internal" href="#mathematical-morphology">1.6.10.3. Mathematical morphology</a></li>
<li><a class="reference internal" href="#connected-components-and-measurements-on-images">1.6.10.4. Connected components and measurements on images</a></li>
</ul>
</li>
<li><a class="reference internal" href="#summary-exercises-on-scientific-computing">1.6.11. Summary exercises on scientific computing</a><ul>
</ul>
</li>
<li><a class="reference internal" href="#full-code-examples-for-the-scipy-chapter">1.6.12. Full code examples for the scipy chapter</a><ul>
<li><a class="reference internal" href="#solutions-of-the-exercises-for-scipy">1.6.12.18. Solutions of the exercises for scipy</a><ul>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="matplotlib/auto_examples/pretty_plots/plot_text_ext.html"
                        title="previous chapter">Text printing decorated</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="summary-exercises/stats-interpolate.html"
                        title="next chapter">1.6.11.1. Maximum wind speed prediction at the Sprogø station</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/intro/scipy.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="summary-exercises/stats-interpolate.html" title="1.6.11.1. Maximum wind speed prediction at the Sprogø station"
             >next</a></li>
        <li class="right" >
          <a href="matplotlib/auto_examples/pretty_plots/plot_text_ext.html" title="Text printing decorated"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Scipy lecture notes</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >1. Getting started with Python for science</a> &#187;</li>
     
    <!-- Insert a menu in the navigation bar -->
    <li class="left">
	<!-- On click toggle the 'tip' on or off-->
	<a onclick="$('.tip').each(function (index, obj) {
			    collapse_tip_div(obj);
		    });
		    $('.tip').addClass('collapsed');
		    $('.left').addClass('transparent');">
	<img src="../_static/minus.png"
         alt="Collapse to compact view" style="padding: 1ex;"/>
	<span class="hiddenlink">Collapse document to compact view</span>
    </a></li>
    <li class="right edit_on_github"><a href="https://github.com/scipy-lectures/scipy-lecture-notes/edit/master/intro/scipy.rst">Edit
    <span class="tooltip">
	Improve this page:<br/>Edit it on Github.
    </span>
    </a>
    </li>

      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2012,2013,2015,2016,2017,2018,2019,2020,2021,2022.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.9.
    </div>
  </body>
</html>